REDIRECTION     

EXPLICATION :
Le site ne contrôle pas les destinations de ses redirections, ce qui 
permet de renvoyer l'utilisateur vers n'importe quel site externe. 

L'URL vulnérable est souvent identifiée via les outils de développement 
(F12) en observant comment le paramètre de destination est traité.

COMMANDE CURL POUR TESTER :
curl -I "http://localhost:8080/index.php?page=redirect&site=http://malveillant.com"

(L'option -I permet de voir l'en-tête "Location" dans la réponse HTTP 
qui confirme la redirection vers le site externe).

DANGERS :
Cette faille est principalement utilisée pour des attaques de Phishing 
(hameçonnage). L'attaquant envoie un lien commençant par un domaine de 
confiance, ce qui rassure la victime, mais le paramètre "site" redirige 
en réalité vers une copie malveillante du site pour voler des identifiants.

SOLUTIONS :
1. Utiliser une "Whitelist" (liste blanche)
   - Créer une liste de domaines autorisés et rejeter systématiquement 
     toute redirection vers un site hors de cette liste.

2. Page d'avertissement intermédiaire
   - Avant la redirection, afficher une page informant l'utilisateur 
     qu'il quitte le site actuel, en affichant l'URL de destination 
     complète.

3. Redirections internes uniquement
   - Préférer des chemins relatifs (ex: site=/dashboard) gérés 
     directement par le backend, plutôt que d'accepter des URL 
     absolues (http://...).

4. Utiliser des identifiants (ID)
   - Au lieu de passer l'URL en paramètre, passer un ID (ex: site=1) 
     que le serveur traduit ensuite en une URL sûre stockée en base 
     de données.